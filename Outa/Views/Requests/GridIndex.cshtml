@model PagedList.IPagedList<Outa.Models.Request>
@using PagedList;
@using PagedList.Mvc;
@{
    ViewBag.Title = "GridIndex";
    Layout = "/Views/Shared/LayoutFluid.cshtml";
}
<html lang="en" class="no-js">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="~/Content/component.css"/>
    <link rel="stylesheet" type="text/css" href="~/Content/hover.css" />
    <script src="~/Scripts/jquery-1.10.2.min.js"></script>
    <script src="~/Scripts/jquery.infinitescroll.min.js"></script>
    <script src="~/Scripts/masonry.pkgd.min.js"></script>
    <script src="~/Scripts/imagesloaded.pkgd.js"></script>
</head>
<body>
    <header>
        <h1>Recent Requests</h1>
    </header>
    <div class="container-fluid" id="grid-container">
        <div class="grid" id="grid">
@foreach (var item in ViewBag.onePage)
{
            <div class="grid-item">
                <a href="@Url.Action("Details", "Requests", new { id = item.Id }, null)" style="text-decoration:none">
                    <div class="hvr-grow">
                <div class="requesttable">
                    <h2 style="color:#FF4040">@item.Title</h2>
                    <img src="@item.Img" align="middle" />
                    <div class="requestcontent">
                        <p>@item.AuthorUn</p>
                        <p>@item.Date</p>
                        <p>@item.Tags</p>
                    </div>
                    </div>
                        </div>
                </a>
            </div>
}
            <div id="page-nav">
                <a id="next-page" href="/Requests/GridIndex?page=2" rel="next">»</a>
            </div>
        </div>
    </div>
    <script>
        (function () {

            // Main content container
            var $container = $('#grid');

            // Masonry + ImagesLoaded
            $container.imagesLoaded(function () {
                $container.masonry({
                    // selector for entry content
                    itemSelector: '.grid-item',
                });
            });

            // Infinite Scroll
            $container.infinitescroll({

                // selector for the paged navigation (it will be hidden)
                navSelector: "#page-nav",
                // selector for the NEXT link (to page 2)
                nextSelector: "#next-page",
                // selector for all items you'll retrieve
                itemSelector: ".grid-item",

                // finished message
                loading: {
                    finishedMsg: 'No more pages to load.'
                }
            },

                // Trigger Masonry as a callback
		function (newElements) {
		    // hide new items while they are loading
		    var $newElems = $(newElements).css({ opacity: 0 });
		    $newElems.animate({ opacity: 1 });
		    $container.masonry('appended', $newElems, true);
		    // ensure that images load before adding to masonry layout
		    $newElems.imagesLoaded(function () {
		        // show elems now they're ready
		        $newElems.animate({ opacity: 1 });
		        $container.masonry('appended', $newElems, true);
		    });

		});

        })();
    </script>
</body>
</html>